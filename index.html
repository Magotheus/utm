<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formulário com UTM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

  <h1>Cadastro de Contato</h1>

  <!-- Embed do formulário Dynamics 365 -->
  <div
    data-form-id="12129189-886d-f011-b4cc-002248e0c319"
    data-form-api-url="https://public-sam.mkt.dynamics.com/api/v1.0/orgs/50c92ef0-554c-f011-8ee3-002248385fe1/landingpageforms"
    data-cached-form-url="https://assets-sam.mkt.dynamics.com/50c92ef0-554c-f011-8ee3-002248385fe1/digitalassets/standaloneforms/12129189-886d-f011-b4cc-002248e0c319">
  </div>

  <!-- Script do Dynamics -->
  <script src="https://js.dynamicsforms.marketing.dynamics.com/ma/ma.js"></script>

  <!-- Script para captura de parâmetros UTM -->
  <script>
    function setUTMToForm() {
      const params = new URLSearchParams(window.location.search);
      const utmMap = {
        utm_source: "sol_utmsource",
        utm_medium: "sol_utmmedium",
        utm_campaign: "sol_utmcampaign",
        utm_term: "sol_utmterm"
      };

      const interval = setInterval(() => {
        const form = document.querySelector("form");
        if (!form) return;

        for (const [utmParam, fieldName] of Object.entries(utmMap)) {
          const value = params.get(utmParam);
          if (value) {
            const input = form.querySelector(`[name="${fieldName}"]`);
            if (input) input.value = value;
          }
        }

        clearInterval(interval);
      }, 1000); // aguarda até o form carregar no DOM
    }

    window.addEventListener("DOMContentLoaded", setUTMToForm);
  </script>

</body>
</html>
